<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title>Local DB</title>
    <link rel='stylesheet' href="/extra/bootstrap.min.css">
    <link rel='stylesheet' href="/extra/misc.css">
    <script src='/extra/jquery.min.js'/>
    <script src="/extra/bootstrap.min.js"></script>
    <style>
               
    </style>
</head>
<body class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
        <form action="/">
            <div class="input-group">
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-primary" onclick="window.location = '/'">Home</button>
                    </span>
                <input type="text" name="query" class="form-control" id='inp' autocomplete="off" list="search" value="{}">
                <span class="input-group-btn bg-t-360">
                    <button type='button' class='btn btn-submit btn-primary' onclick='rand_img()'>Random image</button>
                </span>
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-primary">Search</button>
                </span>
            </div>
            <input name="page" value="1" style="visibility: hidden; width: 0; height: 0">
        </form>
        </div>
    </div>
        <div class="page" id="content">
            <div class="row">
                <div class="col-lg-12">
                {}
                </div>
            </div>
        </div>
        <div class='centered' align='center'>
            <ul class="pagination flex-wrap centered" align='center'>
                {}
            </ul>
        </div>
    <script type="text/javascript">
        function rand_img(){{
            xhr = new XMLHttpRequest;
            xhr.open("GET", '/random', true);
            xhr.send()
            xhr.onreadystatechange = function (e) {{
                if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200){{
                    window.location.href = xhr.responseText;
                }}
            }}
        }}
    var mouse = false
    document.onkeydown = function (e) {{
        if (e.keyCode === 39 && e.target.className != "form-control") {{
            window.location = String(window.location).split("&")[0]+"&"+'page='+String(Number(String(window.location).split("&")[1].split('=')[1])+1)
        }}
        if (e.keyCode === 37 && e.target.className != "form-control") {{
            if (Number(String(window.location).split("&")[1].split('=')[1])-1 == 0){{
                var pass = 1
            }}else{{
                window.location = String(window.location).split("&")[0]+"&"+'page='+String(Number(String(window.location).split("&")[1].split('=')[1])-1)
            }}
        }}
        if (e.keyCode === 82 && e.target.className != "form-control") {{
                rand_img()
            }}
        }}
    function dbclick(id){{
        myWindow = window.open("/export?id="+id, "myWindow", "width=200, height=100");
        setTimeout(function(){{myWindow.close()}}, 1000);
    }}
    function sclick(id) {{
        win = window.open("/image/"+id, '_blank');
        win.focus()//
    }}
    </script>
    <datalist id="search" style="display: none">
    </datalist>
    <script type="application/javascript">
        function update_datalist() {{
            document.getElementById('search').innerHTML = '';
            phrase = this.value;
            xhr = new XMLHttpRequest();
            xhr.open("GET", '/predict?phrase='+phrase, true);
            xhr.send();
            xhr.onreadystatechange = function () {{
                document.getElementById('search').innerHTML = xhr.responseText;
            }}
        }}
        document.getElementById('inp').addEventListener('input', update_datalist)
        function rand_img(){{
            xhr = new XMLHttpRequest;
            xhr.open("GET", '/random', true);
            xhr.send()
            xhr.onreadystatechange = function (e) {{
                if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200){{
                    window.location.href = xhr.responseText;
                }}
            }}
        }}
    </script>
</body>
</html>
